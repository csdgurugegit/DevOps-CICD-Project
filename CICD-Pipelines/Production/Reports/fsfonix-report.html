
Dockerfile (dockerfile)
=======================
Tests: 27 (SUCCESSES: 24, FAILURES: 3, EXCEPTIONS: 0)
Failures: 3 (UNKNOWN: 0, LOW: 1, MEDIUM: 1, HIGH: 1, CRITICAL: 0)

MEDIUM: Specify a tag in the 'FROM' statement for image 'nginx'
════════════════════════════════════════
When using a 'FROM' statement you should use a specific tag to avoid uncontrolled behavior when the image is updated.

See https://avd.aquasec.com/misconfig/ds001
────────────────────────────────────────
 Dockerfile:1
────────────────────────────────────────
   1 [ FROM nginx
────────────────────────────────────────


HIGH: Specify at least 1 USER command in Dockerfile with non-root user as argument
════════════════════════════════════════
Running containers with 'root' user can lead to a container escape situation. It is a best practice to run containers as non-root users, which can be done by adding a 'USER' statement to the Dockerfile.

See https://avd.aquasec.com/misconfig/ds002
────────────────────────────────────────


LOW: Add HEALTHCHECK instruction in your Dockerfile
════════════════════════════════════════
You should add HEALTHCHECK instruction in your docker container images to perform the health check on running containers.

See https://avd.aquasec.com/misconfig/ds026
────────────────────────────────────────



k8/nginx-deployment.yaml (kubernetes)
=====================================
Tests: 140 (SUCCESSES: 126, FAILURES: 14, EXCEPTIONS: 0)
Failures: 14 (UNKNOWN: 0, LOW: 9, MEDIUM: 3, HIGH: 2, CRITICAL: 0)

MEDIUM: Container 'fonix-web-app' of Deployment 'nginx-deployment' should set 'securityContext.allowPrivilegeEscalation' to false
════════════════════════════════════════
A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.

See https://avd.aquasec.com/misconfig/ksv001
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


LOW: Container 'fonix-web-app' of Deployment 'nginx-deployment' should add 'ALL' to 'securityContext.capabilities.drop'
════════════════════════════════════════
The container should drop all default capabilities and add only those that are needed for its execution.

See https://avd.aquasec.com/misconfig/ksv003
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


LOW: Container 'fonix-web-app' of Deployment 'nginx-deployment' should set 'resources.limits.cpu'
════════════════════════════════════════
Enforcing CPU limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv011
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


MEDIUM: Container 'fonix-web-app' of Deployment 'nginx-deployment' should set 'securityContext.runAsNonRoot' to true
════════════════════════════════════════
Force the running image to run as a non-root user to ensure least privileges.

See https://avd.aquasec.com/misconfig/ksv012
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


HIGH: Container 'fonix-web-app' of Deployment 'nginx-deployment' should set 'securityContext.readOnlyRootFilesystem' to true
════════════════════════════════════════
An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.

See https://avd.aquasec.com/misconfig/ksv014
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


LOW: Container 'fonix-web-app' of Deployment 'nginx-deployment' should set 'resources.requests.cpu'
════════════════════════════════════════
When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv015
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


LOW: Container 'fonix-web-app' of Deployment 'nginx-deployment' should set 'resources.requests.memory'
════════════════════════════════════════
When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.

See https://avd.aquasec.com/misconfig/ksv016
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


LOW: Container 'fonix-web-app' of Deployment 'nginx-deployment' should set 'resources.limits.memory'
════════════════════════════════════════
Enforcing memory limits prevents DoS via resource exhaustion.

See https://avd.aquasec.com/misconfig/ksv018
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


LOW: Container 'fonix-web-app' of Deployment 'nginx-deployment' should set 'securityContext.runAsUser' > 10000
════════════════════════════════════════
Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv020
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


LOW: Container 'fonix-web-app' of Deployment 'nginx-deployment' should set 'securityContext.runAsGroup' > 10000
════════════════════════════════════════
Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.

See https://avd.aquasec.com/misconfig/ksv021
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


LOW: Either Pod or Container should set 'securityContext.seccompProfile.type' to 'RuntimeDefault'
════════════════════════════════════════
According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.

See https://avd.aquasec.com/misconfig/ksv030
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


MEDIUM: container "fonix-web-app" of deployment "nginx-deployment" in "webapps" namespace should specify a seccomp profile
════════════════════════════════════════
A program inside the container can bypass Seccomp protection policies.

See https://avd.aquasec.com/misconfig/ksv104
────────────────────────────────────────


LOW: container should drop all
════════════════════════════════════════
Containers must drop ALL capabilities, and are only permitted to add back the NET_BIND_SERVICE capability.

See https://avd.aquasec.com/misconfig/ksv106
────────────────────────────────────────
 k8/nginx-deployment.yaml:19-22
────────────────────────────────────────
  19 ┌       - name: fonix-web-app
  20 │         image: csdgurugedockerhub/fonix-webapp:1.1
  21 │         ports:
  22 └         - containerPort: 80
────────────────────────────────────────


HIGH: deployment nginx-deployment in webapps namespace should not set spec.template.spec.containers.ports.containerPort to less than 1024
════════════════════════════════════════
The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.

See https://avd.aquasec.com/misconfig/ksv117
────────────────────────────────────────



terraform/main.tf (terraform)
=============================
Tests: 5 (SUCCESSES: 1, FAILURES: 4, EXCEPTIONS: 0)
Failures: 4 (UNKNOWN: 0, LOW: 3, MEDIUM: 1, HIGH: 0, CRITICAL: 0)

LOW: App service does not have client certificates enabled.
════════════════════════════════════════
The TLS mutual authentication technique in enterprise environments ensures the authenticity of clients to the server. If incoming client certificates are enabled only an authenticated client with valid certificates can access the app.

See https://avd.aquasec.com/misconfig/avd-azu-0001
────────────────────────────────────────
 terraform/main.tf:14-31
────────────────────────────────────────
  14 ┌ resource "azurerm_app_service" "myapp" {
  15 │   name                = var.app_service_name
  16 │   location            = azurerm_resource_group.resource.location
  17 │   resource_group_name = azurerm_resource_group.resource.name
  18 │   app_service_plan_id = azurerm_service_plan.svcplan.id
  19 │ 
  20 │   site_config {
  21 │     always_on        = true
  22 └     linux_fx_version = "DOCKER|${var.dockerhub_username}/fonix-webapp:1.1"
  ..   
────────────────────────────────────────


LOW: App service does not have an identity type.
════════════════════════════════════════
Registering the identity used by an App with AD allows it to interact with other services without using username and password

See https://avd.aquasec.com/misconfig/avd-azu-0002
────────────────────────────────────────
 terraform/main.tf:14-31
────────────────────────────────────────
  14 ┌ resource "azurerm_app_service" "myapp" {
  15 │   name                = var.app_service_name
  16 │   location            = azurerm_resource_group.resource.location
  17 │   resource_group_name = azurerm_resource_group.resource.name
  18 │   app_service_plan_id = azurerm_service_plan.svcplan.id
  19 │ 
  20 │   site_config {
  21 │     always_on        = true
  22 └     linux_fx_version = "DOCKER|${var.dockerhub_username}/fonix-webapp:1.1"
  ..   
────────────────────────────────────────


MEDIUM: App service does not have authentication enabled.
════════════════════════════════════════
Enabling authentication ensures that all communications in the application are authenticated. The auth_settings block needs to be filled out with the appropriate auth backend settings

See https://avd.aquasec.com/misconfig/avd-azu-0003
────────────────────────────────────────
 terraform/main.tf:14-31
────────────────────────────────────────
  14 ┌ resource "azurerm_app_service" "myapp" {
  15 │   name                = var.app_service_name
  16 │   location            = azurerm_resource_group.resource.location
  17 │   resource_group_name = azurerm_resource_group.resource.name
  18 │   app_service_plan_id = azurerm_service_plan.svcplan.id
  19 │ 
  20 │   site_config {
  21 │     always_on        = true
  22 └     linux_fx_version = "DOCKER|${var.dockerhub_username}/fonix-webapp:1.1"
  ..   
────────────────────────────────────────


LOW: App service does not have HTTP/2 enabled.
════════════════════════════════════════
Use the latest version of HTTP to ensure you are benefiting from security fixes

See https://avd.aquasec.com/misconfig/avd-azu-0005
────────────────────────────────────────
 terraform/main.tf:20-23
   via terraform/main.tf:14-31 (azurerm_app_service.myapp)
────────────────────────────────────────
  14   resource "azurerm_app_service" "myapp" {
  ..   
  20 ┌   site_config {
  21 │     always_on        = true
  22 │     linux_fx_version = "DOCKER|${var.dockerhub_username}/fonix-webapp:1.1"
  23 └   }
  ..   
  31   }
────────────────────────────────────────


